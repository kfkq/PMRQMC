# Advanced Measurement Techniques in Quantum Monte Carlo: The Permutation Matrix Representation Approach

## Paper Metadata
- **Title**: Advanced measurement techniques in quantum Monte Carlo: The permutation matrix representation approach
- **Authors**: Nic Ezzell, Itay Hen
- **Publication Date**: arXiv:2504.07295v1 [cond-mat.stat-mech] 9 Apr 2025
- **Key Focus**: Derives exact, closed-form, system-independent estimators for arbitrary static observables, imaginary-time correlators, and integrated susceptibilities in Permutation Matrix Representation Quantum Monte Carlo (PMR-QMC). Emphasizes rigorous PMR definition and canonical forms for reliable estimation. Demonstrates on transverse-field Ising model (TFIM); open-source code available.

## Abstract and Main Contribution
The paper advances PMR-QMC by developing a systematic theory for estimating non-trivial observables. It refines the PMR decomposition for square matrices using Abelian permutation groups, ensuring properties like no fixed points in products. Key contributions include formal estimators for arbitrary static observables \( \langle O \rangle \), imaginary-time correlators \( \langle A(\tau) B \rangle \), and integrals like \( \int_0^\beta \langle A(\tau) B \rangle d\tau \) (energy susceptibility) and \( \int_0^{\beta/2} \tau \langle A(\tau) B \rangle d\tau \) (fidelity susceptibility), without numerical integration. Introduces "canonical form" to avoid estimation biases from division by zeros. Demonstrates versatility on TFIM, estimating random non-local Pauli strings and dynamics. Code [41] extends prior spin-1/2 PMR-QMC [42] for arbitrary observables.

## Background: Permutation Matrix Representation (PMR)
PMR decomposes matrices as \( A = \sum_{j=0}^M D_j P_j = D_0 + \sum_{j=1}^M D_j P_j \), where \( D_j \) are diagonal in orthonormal basis \( \{|i\rangle\} \), and \( \{P_j\} \subset G \) an Abelian permutation group with: (i) simply transitive action on basis (no fixed points except identity, unique P for each pair (i,j)), (ii) commutativity. Canonical PMR uses cyclic groups generated by d-cycles; local canonical for tensor products.

- **Existence**: Any square matrix has Abelian PMR (Theorem 1).
- **Hermiticity**: For Hermitian A, \( (D_j P_j)^\dagger = D_{\sigma(j)} P_{\sigma(j)} \) with \( P_{\sigma(j)} = P_j^{-1} \), implying \( D_j^* = P_j D_{\sigma(j)} P_{\sigma(j)} \) (Theorem 3, correcting prior work).
- **Computing Diagonals**: \( \operatorname{diag}(D_x) = \operatorname{diag}(A P_x^{-1}) \) or \( \operatorname{diag}(P_x A) \) for Hermitian (Theorem 2, Corollary 2).
- **Extensions**: To infinite dimensions (Bose-Hubbard via negative occupations), non-Abelian (fermions).

## Divided Differences Review
Divided difference for holomorphic f over multiset [x0,...,xq]:
\[
f[x_0, \dots, x_q] = \frac{1}{2\pi i} \oint_\Gamma \frac{f(x)}{\prod_{i=0}^q (x - x_i)} dx = \sum_{j=0}^q \frac{f(x_j)}{\prod_{k \neq j} (x_j - x_k)},
\]
or Taylor weights for repeats: \( f[x, \dots, x] = f^{(q)}(x)/q! \). Power series: \( f[x_0,\dots,x_q] = \sum_{m=0}^\infty \frac{f^{(q+m)}(0)}{(q+m)!} \sum_{\sum k_j = m} \prod_{j=0}^q x_j^{k_j} \). For exponentials (DDE): \( e^{t[x_0,\dots,x_q]} \), rescaling \( \alpha^q e^{t[\alpha x_0,\dots,\alpha x_q]} = e^{\alpha t [x_0,\dots,x_q]} \), Laplace relations used for integrals.

## PMR-QMC Formalism
For Hamiltonian in PMR: \( H = D_0 + \sum_j D_j P_j \), partition function \( Z = \Tr[e^{-\beta H}] = \sum_z \sum_{q=0}^\infty \sum_{S_{i_q}=1} D(z, S_{i_q}) e^{-\beta [E_{z_0}, \dots, E_{z_q}]} \), where \( S_{i_q} = P_{i_q} \dots P_{i_1} \), \( D(z, S_{i_q}) = \prod_j \langle z_j | D_{i_j} | z_j \rangle \), \( |z_j\rangle = P_{i_j} |z_{j-1}\rangle \), \( E_{z_j} = \langle z_j | D_0 | z_j \rangle \).

Configurations C = (|z\rangle, S_{i_q}), weights \( W_C = \Re[D(z, S_{i_q}) e^{-\beta [E_{z_0},\dots,E_{z_q}]}] \). Updates (swaps, insertions, cycles) ensure ergodicity and detailed balance [23-25]. DDE computation via addition/removal [65].

## Static Observable Estimators
General: \( \langle O \rangle = \sum_C W_C O_C / \sum_C W_C \).

- **Diagonal**: \( (\Lambda)_C = \Lambda(z) \) (O(1)).
- **Powers of H**: \( (H^k)_C = \sum_{j=0}^{\max(k,q)} [E_{z_j},\dots,E_{z_q}]^k e^{-\beta [E_{z_0},\dots,E_{z_j}]} / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \) (O(k)).
- **Off-Diagonal H**: \( (H_{\text{offdiag}})_C = e^{-\beta [E_{z_0},\dots,E_{z_{q-1}}]} / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \) (O(1)).
- **Terms in H**: \( (D_l P_l)_C = \delta^{(q)}_{P_l} e^{-\beta [E_{z_0},\dots,E_{z_{q-1}}]} / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \) (O(1)).
- **Canonical**: Products \( \Lambda_1 D_{l_1} P_{l_1} \dots \Lambda_L D_{l_L} P_{l_L} \Lambda_{L+1} \) (O(L)).
- **Arbitrary**: Decompose O in same PMR basis as H; if P not in <SH>_g, \( \langle O \rangle = 0 \); else express as canonical product or use non-canonical (may bias if zeros mismatch).

Canonical avoids biases from zero divisions; all observables canonical for TFIM, random H.

## Dynamic Observable Estimators
For \( O(\tau) = e^{\tau H} O e^{-\tau H} \):

- **Correlator**: \( \langle A(\tau) B \rangle_C = \sum_{k,l} \tilde{A}_k(z) \delta^{(q)}_{P_k} \sum_{p=1}^{q-1} \delta^{(p)}_{P_l} \tilde{B}(z_p) e^{-\tau [E_{z_p},\dots,E_{z_{q-1}}]} e^{-(\beta-\tau) [E_{z_0},\dots,E_{z_{p-1}}]} / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \) (O(q^2)).
- **ES Integral**: \( \int_0^\beta \langle A(\tau) B \rangle d\tau_C = - \delta^{(q)}_{P_k} \tilde{A}_k(z) \sum_{p=1}^{q-1} \delta^{(p)}_{P_l} \tilde{B}(z_p) e^{-\beta [E_{z_0},\dots,E_{z_{q-1}}]} / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \) (O(q)).
- **FS Integral**: \( \int_0^{\beta/2} \tau \langle A(\tau) B \rangle d\tau_C = \delta^{(q)}_{P_k} \tilde{A}_k(z) / e^{-\beta [E_{z_0},\dots,E_{z_q}]} \sum_{r=0}^q e^{-\beta/2 [E_{z_0},\dots,E_{z_r}]} \sum_{p,m=r; p \leq m} \delta^{(p)}_{P_l} \tilde{B}(z_p) e^{-\beta/2 [E_{z_r},\dots,E_{z_q},E_{z_p},E_{z_m}]} \) (O(q^4)).

Special cases (e.g., with H_diag) reduce complexity.

## Numerical Testing
- **Verification**: 3x3 TFIM (\beta=1, \lambda=0.5); 32 static/dynamic observables match exact (Fig. 1).
- **Proof-of-Principle**: 8x8 TFIM (\beta=1, \lambda=0.1-1.5); trends for standard/custom (random non-local) observables consistent (Figs. 2-3).
- **Complexity**: Estimators efficient; simulations on laptop, 100 runs/seeds.

## Significance and Outlook
Establishes PMR-QMC as versatile for non-trivial observables beyond prior limits. Canonical form ensures reliability; open questions: efficient canonicalization algorithms? Extends to higher spins, fermions, bosons. Enables spectral studies, quantum criticality via susceptibilities. Code facilitates applications; future: automation, non-Hermitian, continuous-time variants.